<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Journal Application</title>
    <style>
        /* Base Styles */
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f5f6fa;
            --text-color: #2d3436;
            --light-gray: #dfe6e9;
            --white: #ffffff;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--secondary-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Greeting Section */
        .greeting-section {
            background: linear-gradient(135deg, #5fba74, #076ccc);
            color: var(--white);
            padding: 40px 0;
            margin-bottom: 30px;
        }

        .greeting-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .greeting-section h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        #datetime {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Profile Section */
        .profile-section {
            margin-bottom: 40px;
        }

        .profile-card {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .profile-image img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-info h2 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .bio {
            color: #636e72;
            margin-bottom: 15px;
        }

        .profile-stats {
            display: flex;
            gap: 20px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat i {
            color: var(--primary-color);
        }

        /* Journal Section */
        .journal-section {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .journal-filters {
            margin-bottom: 25px;
        }

        .filter-btn {
            background: none;
            border: none;
            padding: 8px 16px;
            margin-right: 10px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: var(--white);
        }

        .journal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .journal-card {
            background: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .journal-card:hover {
            transform: translateY(-5px);
        }

        .journal-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .author-img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .author-info h3 {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .date {
            font-size: 0.9rem;
            color: #636e72;
        }

        .journal-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .journal-preview {
            color: #636e72;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .journal-footer {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .journal-footer span {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #636e72;
            font-size: 0.9rem;
        }

        .read-more {
            margin-left: auto;
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .read-more:hover {
            background: #2980b9;
        }
        #sidebar {
            background-color: #1f2937; /* Dark gray background */
            color: #fff;               /* White text */
            transition: all 0.3s ease;
        }

        #sidebar a {
            color: #cbd5e1;            /* Light gray text for links */
            text-decoration: none;
        }

        #sidebar a:hover {
            background-color: #374151; /* Darker background on hover */
            color: #fff;
        }

        #sidebar i {
            color: #9ca3af;            /* Icon color */
        }

        /* For WebKit browsers (Chrome, Safari) */
        ::-webkit-scrollbar {
            display: none;  /* Hides scrollbar */
        }

        /* For all browsers (universal approach) */
        body {
            -ms-overflow-style: none;  /* For Internet Explorer and Edge */
            scrollbar-width: none;     /* For Firefox */
        }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>

<body>


<!-- Greeting Section -->
<div class="greeting-section">
    <div class="greeting-container">
        <h1  id="greeting" >Welcome </h1>
        <div class="quote" id="quote">Fetching today's quote...</div>
<!--        <div class="greeting">Loading...</div>-->
        <p id="datetime"></p>
    </div>
</div>

<!-- Main Content -->
<div class="container">
    <!-- Profile Section -->
    <section class="profile-section">
        <div class="profile-card">
            <div class="profile-header">
                <div class="profile-image">
                    <img src="image/profile.png" alt="Profile Picture" >
                </div>
                <div class="profile-info">
                    <h2 id="username">...</h2>
<!--                    <p class="bio">Journal enthusiast | Writer | Creative mind</p>-->
                    <div class="profile-stats">
                        <div class="stat">
                            <i class="fas fa-book"></i>
                            <span>15 Journals</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-users"></i>
                            <span>120 Followers</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Journal Section -->
    <section class="journal-section">
        <h2 class="section-title">Latest Journals</h2>
        <div class="journal-filters">
            <button class="filter-btn active">All</button>
            <button class="filter-btn">Popular</button>
            <button class="filter-btn">Recent</button>
        </div>
        <div class="journal-grid">
            <!-- Journal Card 1 -->
            <div class="journal-card">
                <div class="journal-header">
                    <img src="#" alt="Author" class="author-img">
                    <div class="author-info">
                        <h3>Sarah Johnson</h3>
                        <span class="date">March 9, 2025</span>
                    </div>
                </div>
                <h4 class="journal-title">My Journey Through Spring</h4>
                <p class="journal-preview">Today marks the beginning of spring, and I couldn't be more excited about the changes I'm seeing around me...</p>
                <div class="journal-footer">
                    <span><i class="fas fa-heart"></i> 24</span>
                    <span><i class="fas fa-comment"></i> 8</span>
                    <button class="read-more">Read More</button>
                </div>
            </div>

            <!-- Journal Card 2 -->
            <div class="journal-card">
                <div class="journal-header">
                    <img src="#" alt="Author" class="author-img">
                    <div class="author-info">
                        <h3>Mike Chen</h3>
                        <span class="date">March 8, 2025</span>
                    </div>
                </div>
                <h4 class="journal-title">Urban Photography Adventures</h4>
                <p class="journal-preview">Exploring the city streets with my camera has become my favorite weekend activity. The urban landscape...</p>
                <div class="journal-footer">
                    <span><i class="fas fa-heart"></i> 32</span>
                    <span><i class="fas fa-comment"></i> 12</span>
                    <button class="read-more">Read More</button>
                </div>
            </div>
        </div>
    </section>
</div>

<script>

    function handleLogout() {
        localStorage.removeItem("jwt_token");
        window.location.href = 'http://localhost:8080/RGT/home.html';
    }

    function isTokenExpired(token) {
        const payload = JSON.parse(atob(token.split('.')[1]));
        const expiry = payload.exp;
        const now = Math.floor(Date.now() / 1000);
        return now >= expiry;
    }


    async function fetchGreeting() {
        const token = localStorage.getItem("jwt_token");

        if (!token) {
            window.location.href = "/RGT/login.html";
            return;
        }

        try {
            const response = await fetch("/user/index", {
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${token}`
                }
            });

            if (response.ok) {
                const textResponse = await response.text();
                const [greetPart, quotePart] = textResponse.split("\n");

                document.getElementById("greeting").textContent += greetPart.trim();
                document.getElementById("username").textContent = greetPart.trim().toUpperCase();
                document.getElementById("quote").textContent = quotePart.trim();
            } else {
                console.log("Authentication failed. Redirecting to login.");
                handleLogout();
            }
        } catch (error) {
            console.error("Error:", error);
            handleLogout();
        }
    }
    let debounceTimer;
    function withdelay() {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
            fetchGreeting();  // Your function to call the backend API
        }, 3000);  // Adjust delay as needed
    }
    window.addEventListener("load", withdelay);
</script>

</body>
</html>